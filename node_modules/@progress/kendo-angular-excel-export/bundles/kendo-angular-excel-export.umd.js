/**-----------------------------------------------------------------------------------------
* Copyright © 2021 Progress Software Corporation. All rights reserved.
* Licensed under commercial license. See LICENSE.md in the project root for more information
*-------------------------------------------------------------------------------------------*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@progress/kendo-file-saver"),require("@progress/kendo-ooxml"),require("@progress/kendo-intl"),require("@progress/kendo-angular-l10n"),require("@progress/kendo-licensing")):"function"==typeof define&&define.amd?define("KendoAngularExcelExport",["exports","@angular/core","@progress/kendo-file-saver","@progress/kendo-ooxml","@progress/kendo-intl","@progress/kendo-angular-l10n","@progress/kendo-licensing"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).KendoAngularExcelExport={},e.ng.core,e.KendoFileSaver,e.KendoOoxml,e.KendoIntl,e.KendoAngularL10N,e.KendoLicensing)}(this,function(t,r,o,n,e,i,a){"use strict";function p(r){var o;return r&&r.__esModule?r:(o=Object.create(null),r&&Object.keys(r).forEach(function(e){var t;"default"!==e&&(t=Object.getOwnPropertyDescriptor(r,e),Object.defineProperty(o,e,t.get?t:{enumerable:!0,get:function(){return r[e]}}))}),o.default=r,Object.freeze(o))}function l(e,t,r){function o(e){return r(t,e),n.detectChanges(),n.rootNodes.reduce(function(e,t){return e+t.textContent},"").trim()}var n=e.createEmbeddedView(t);return o.destroy=function(){n.destroy(),n=null},o}function s(e,t){e.$implicit=e.group=t,e.field=t.field,e.value=t.value,e.aggregates=t.aggregates}function c(e,t){e.group=t.group,e.$implicit=e.aggregates=t}function d(e,t){e.aggregates=t.aggregates}function u(e){function n(e,r,o){e.forEach(function(t){var e;t.level===o&&(e=new j(t,i),r.push(e),t.children&&t.children.some(function(e){return e!==t})?(e=e.columns=[],n(t.children,e,o+1)):i++)})}var t=[],i=0;return n(e,t,0),t}function g(e){e&&e.forEach(function(e){e.destroy()})}var m=p(r),f=p(i),j=(y.prototype.destroy=function(){this.footerTemplate&&this.footerTemplate.destroy(),this.groupFooterTemplate&&this.groupFooterTemplate.destroy(),this.groupHeaderTemplate&&this.groupHeaderTemplate.destroy(),this.groupHeaderColumnTemplate&&this.groupHeaderColumnTemplate.destroy(),g(this.columns)},y);function y(e,t){this.title=e.title,this.field=e.field,this.hidden=e.hidden,this.locked=e.locked,this.width=e.width,this.headerCellOptions=e.headerCellOptions,this.cellOptions=e.cellOptions,this.groupHeaderCellOptions=e.groupHeaderCellOptions,this.groupFooterCellOptions=e.groupFooterCellOptions,this.footerCellOptions=e.footerCellOptions,e.footerTemplate&&(this.footerTemplate=l(e.footerTemplate.templateRef,{$implicit:e,column:e,columnIndex:t},d)),e.groupFooterTemplate&&(this.groupFooterTemplate=l(e.groupFooterTemplate.templateRef,{column:e,field:e.field},c)),e.groupHeaderTemplate&&(this.groupHeaderTemplate=l(e.groupHeaderTemplate.templateRef,{},s)),e.groupHeaderColumnTemplate&&(this.groupHeaderColumnTemplate=l(e.groupHeaderColumnTemplate.templateRef,{},s))}n.IntlService.register({toString:e.toString});function h(e){var t=u(e.columns),r=new n.ExcelExporter({columns:t,data:e.data,filterable:e.filterable,groups:e.group,paddingCellOptions:e.paddingCellOptions,headerPaddingCellOptions:e.headerPaddingCellOptions,collapsible:e.collapsible,hierarchy:e.hierarchy,aggregates:e.aggregates}).workbook();return r.creator=e.creator,r.date=e.date,r.rtl=e.rtl,g(t),r}function v(e){return new n.Workbook(e).toDataURL()}function C(e){return e&&e.sheets}Object.defineProperty(O.prototype,"level",{get:function(){return this.parent?this.parent.level+1:0},enumerable:!1,configurable:!0});var x=O;function O(e){this.parent=e}x.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:x,deps:[{token:x}],target:m.ɵɵFactoryTarget.Component}),x.ɵcmp=m.ɵɵngDeclareComponent({minVersion:"12.0.0",version:"12.2.16",type:x,selector:"ng-component",inputs:{title:"title",width:"width",locked:"locked",hidden:"hidden",headerCellOptions:"headerCellOptions"},queries:[{propertyName:"children",predicate:x}],ngImport:m,template:"",isInline:!0}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:x,decorators:[{type:r.Component,args:[{template:""}]}],ctorParameters:function(){return[{type:x}]},propDecorators:{title:[{type:r.Input}],width:[{type:r.Input}],locked:[{type:r.Input}],hidden:[{type:r.Input}],headerCellOptions:[{type:r.Input}],children:[{type:r.ContentChildren,args:[x]}]}});var _={name:"@progress/kendo-angular-excel-export",productName:"Kendo UI for Angular",productCodes:["KENDOUIANGULAR","KENDOUICOMPLETE"],publishDate:1668698474,version:"",licensingDocsUrl:"https://www.telerik.com/kendo-angular-ui/my-license/?utm_medium=product&utm_source=kendoangular&utm_campaign=kendo-ui-angular-purchase-license-keys-warning"},e=(k.prototype.save=function(e){this.toDataURL(e).then(this.saveFile)},k.prototype.workbookOptions=function(e){e=this.getExportData(e);return h({columns:this.columns,data:e.data,group:e.group,filterable:this.filterable,creator:this.creator,date:this.date,rtl:this.localization.rtl,paddingCellOptions:this.paddingCellOptions,headerPaddingCellOptions:this.headerPaddingCellOptions,collapsible:this.collapsible})},k.prototype.toDataURL=function(e){var t=C(e)?e:this.workbookOptions(e);return this.zone.runOutsideAngular(function(){return v(t)})},k.prototype.getExportData=function(e){e=e?Array.isArray(e)?{data:e}:e:{data:this.data,group:this.group};return e},k.prototype.saveFile=function(e){o.saveAs(e,this.fileName,{forceProxy:this.forceProxy,proxyURL:this.proxyURL})},k);function k(e,t){this.localization=e,this.zone=t,this.fileName="Export.xlsx",this.columns=new r.QueryList,a.validatePackage(_),this.saveFile=this.saveFile.bind(this)}e.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:e,deps:[{token:f.LocalizationService},{token:m.NgZone}],target:m.ɵɵFactoryTarget.Component}),e.ɵcmp=m.ɵɵngDeclareComponent({minVersion:"12.0.0",version:"12.2.16",type:e,selector:"kendo-excelexport",inputs:{fileName:"fileName",filterable:"filterable",collapsible:"collapsible",creator:"creator",date:"date",forceProxy:"forceProxy",proxyURL:"proxyURL",data:"data",group:"group",paddingCellOptions:"paddingCellOptions",headerPaddingCellOptions:"headerPaddingCellOptions"},providers:[i.LocalizationService,{provide:i.L10N_PREFIX,useValue:"kendo.excelexport"}],queries:[{propertyName:"columns",predicate:x,descendants:!0}],exportAs:["kendoExcelExport"],ngImport:m,template:"",isInline:!0}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:e,decorators:[{type:r.Component,args:[{exportAs:"kendoExcelExport",selector:"kendo-excelexport",providers:[i.LocalizationService,{provide:i.L10N_PREFIX,useValue:"kendo.excelexport"}],template:""}]}],ctorParameters:function(){return[{type:f.LocalizationService},{type:m.NgZone}]},propDecorators:{fileName:[{type:r.Input}],filterable:[{type:r.Input}],collapsible:[{type:r.Input}],creator:[{type:r.Input}],date:[{type:r.Input}],forceProxy:[{type:r.Input}],proxyURL:[{type:r.Input}],data:[{type:r.Input}],group:[{type:r.Input}],paddingCellOptions:[{type:r.Input}],headerPaddingCellOptions:[{type:r.Input}],columns:[{type:r.ContentChildren,args:[x,{descendants:!0}]}]}});var I=function(e,t){return(I=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}Object.create;Object.create;var D,i=function(e){this.templateRef=e},E=(i.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:i,deps:[{token:m.TemplateRef,optional:!0}],target:m.ɵɵFactoryTarget.Directive}),i.ɵdir=m.ɵɵngDeclareDirective({minVersion:"12.0.0",version:"12.2.16",type:i,selector:"[kendoExcelExportGroupHeaderTemplate]",ngImport:m}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:i,decorators:[{type:r.Directive,args:[{selector:"[kendoExcelExportGroupHeaderTemplate]"}]}],ctorParameters:function(){return[{type:m.TemplateRef,decorators:[{type:r.Optional}]}]}}),function(e){this.templateRef=e}),b=(E.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:E,deps:[{token:m.TemplateRef,optional:!0}],target:m.ɵɵFactoryTarget.Directive}),E.ɵdir=m.ɵɵngDeclareDirective({minVersion:"12.0.0",version:"12.2.16",type:E,selector:"[kendoExcelExportGroupHeaderColumnTemplate]",ngImport:m}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:E,decorators:[{type:r.Directive,args:[{selector:"[kendoExcelExportGroupHeaderColumnTemplate]"}]}],ctorParameters:function(){return[{type:m.TemplateRef,decorators:[{type:r.Optional}]}]}}),function(e){this.templateRef=e}),F=(b.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:b,deps:[{token:m.TemplateRef,optional:!0}],target:m.ɵɵFactoryTarget.Directive}),b.ɵdir=m.ɵɵngDeclareDirective({minVersion:"12.0.0",version:"12.2.16",type:b,selector:"[kendoExcelExportGroupFooterTemplate]",ngImport:m}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:b,decorators:[{type:r.Directive,args:[{selector:"[kendoExcelExportGroupFooterTemplate]"}]}],ctorParameters:function(){return[{type:m.TemplateRef,decorators:[{type:r.Optional}]}]}}),function(e){this.templateRef=e}),P=(F.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:F,deps:[{token:m.TemplateRef,optional:!0}],target:m.ɵɵFactoryTarget.Directive}),F.ɵdir=m.ɵɵngDeclareDirective({minVersion:"12.0.0",version:"12.2.16",type:F,selector:"[kendoExcelExportFooterTemplate]",ngImport:m}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:F,decorators:[{type:r.Directive,args:[{selector:"[kendoExcelExportFooterTemplate]"}]}],ctorParameters:function(){return[{type:m.TemplateRef,decorators:[{type:r.Optional}]}]}}),T(R,D=x),R);function R(e){return D.call(this,e)||this}P.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:P,deps:[{token:x,host:!0,optional:!0,skipSelf:!0}],target:m.ɵɵFactoryTarget.Component}),P.ɵcmp=m.ɵɵngDeclareComponent({minVersion:"12.0.0",version:"12.2.16",type:P,selector:"kendo-excelexport-column",inputs:{field:"field",cellOptions:"cellOptions",groupHeaderCellOptions:"groupHeaderCellOptions",groupFooterCellOptions:"groupFooterCellOptions",footerCellOptions:"footerCellOptions"},providers:[{provide:x,useExisting:r.forwardRef(function(){return P})}],queries:[{propertyName:"groupHeaderTemplate",first:!0,predicate:i,descendants:!0},{propertyName:"groupHeaderColumnTemplate",first:!0,predicate:E,descendants:!0},{propertyName:"groupFooterTemplate",first:!0,predicate:b,descendants:!0},{propertyName:"footerTemplate",first:!0,predicate:F,descendants:!0}],usesInheritance:!0,ngImport:m,template:"",isInline:!0}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:P,decorators:[{type:r.Component,args:[{providers:[{provide:x,useExisting:r.forwardRef(function(){return P})}],selector:"kendo-excelexport-column",template:""}]}],ctorParameters:function(){return[{type:x,decorators:[{type:r.SkipSelf},{type:r.Host},{type:r.Optional}]}]},propDecorators:{field:[{type:r.Input}],cellOptions:[{type:r.Input}],groupHeaderCellOptions:[{type:r.Input}],groupFooterCellOptions:[{type:r.Input}],footerCellOptions:[{type:r.Input}],groupHeaderTemplate:[{type:r.ContentChild,args:[i,{static:!1}]}],groupHeaderColumnTemplate:[{type:r.ContentChild,args:[E,{static:!1}]}],groupFooterTemplate:[{type:r.ContentChild,args:[b,{static:!1}]}],footerTemplate:[{type:r.ContentChild,args:[F,{static:!1}]}]}});T(H,V=x);var V,w=H;function H(e){var t=V.call(this,e)||this;return t.parent=e,t}w.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:w,deps:[{token:x,host:!0,optional:!0,skipSelf:!0}],target:m.ɵɵFactoryTarget.Component}),w.ɵcmp=m.ɵɵngDeclareComponent({minVersion:"12.0.0",version:"12.2.16",type:w,selector:"kendo-excelexport-column-group",providers:[{provide:x,useExisting:r.forwardRef(function(){return w})}],usesInheritance:!0,ngImport:m,template:"",isInline:!0}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:w,decorators:[{type:r.Component,args:[{providers:[{provide:x,useExisting:r.forwardRef(function(){return w})}],selector:"kendo-excelexport-column-group",template:""}]}],ctorParameters:function(){return[{type:x,decorators:[{type:r.SkipSelf},{type:r.Host},{type:r.Optional}]}]}});var N=[e,P,w,F,b,i,E],L=function(){};L.ɵfac=m.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:L,deps:[],target:m.ɵɵFactoryTarget.NgModule}),L.ɵmod=m.ɵɵngDeclareNgModule({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:L,declarations:[e,P,w,F,b,i,E],exports:[e,P,w,F,b,i,E]}),L.ɵinj=m.ɵɵngDeclareInjector({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:L}),m.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"12.2.16",ngImport:m,type:L,decorators:[{type:r.NgModule,args:[{declarations:[N],exports:[N]}]}]}),t.ColumnBase=x,t.ColumnComponent=P,t.ColumnGroupComponent=w,t.ExcelExportComponent=e,t.ExcelExportModule=L,t.FooterTemplateDirective=F,t.GroupFooterTemplateDirective=b,t.GroupHeaderColumnTemplateDirective=E,t.GroupHeaderTemplateDirective=i,t.isWorkbookOptions=C,t.toDataURL=v,t.workbookOptions=h,Object.keys(n).forEach(function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}),Object.defineProperty(t,"__esModule",{value:!0})});